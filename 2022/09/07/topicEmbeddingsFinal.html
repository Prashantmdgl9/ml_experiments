<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="twitter:card" content="summary_large_image" /><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Imports | Musings of Learning Machine Learning</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="Imports" />
<meta name="author" content="Prashant Mudgal" />
<meta property="og:locale" content="en_US" />
<link rel="canonical" href="https://prashantmdgl9.github.io/ml_experiments/2022/09/07/topicEmbeddingsFinal.html" />
<meta property="og:url" content="https://prashantmdgl9.github.io/ml_experiments/2022/09/07/topicEmbeddingsFinal.html" />
<meta property="og:site_name" content="Musings of Learning Machine Learning" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2022-09-07T00:00:00-05:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Imports" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Prashant Mudgal"},"dateModified":"2022-09-07T00:00:00-05:00","datePublished":"2022-09-07T00:00:00-05:00","headline":"Imports","mainEntityOfPage":{"@type":"WebPage","@id":"https://prashantmdgl9.github.io/ml_experiments/2022/09/07/topicEmbeddingsFinal.html"},"url":"https://prashantmdgl9.github.io/ml_experiments/2022/09/07/topicEmbeddingsFinal.html"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/ml_experiments/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://prashantmdgl9.github.io/ml_experiments/feed.xml" title="Musings of Learning Machine Learning" /><link rel="shortcut icon" type="image/x-icon" href="/ml_experiments/images/favicon2.ico">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Primer/15.2.0/primer.css" integrity="sha512-xTz2ys4coGAOz8vuV1NcQBkgVmKhsSEtjbqyMJbBHRplFuvKIUo6xhLHpAyPt9mfR6twHJgn9OgVLuqOvjeBhg==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous" />

<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title") && (el.className != "emoji")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/ml_experiments/">Musings of Learning Machine Learning</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/ml_experiments/about/">About Me</a><a class="page-link" href="/ml_experiments/Applications/">Applications</a><a class="page-link" href="/ml_experiments/CV/">CV</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Imports</h1><p class="post-meta post-meta-title"><time class="dt-published" datetime="2022-09-07T00:00:00-05:00" itemprop="datePublished">
        Sep 7, 2022
      </time>
       â€¢ <span class="read-time" title="Estimated read time">
    
    
      6 min read
    
</span></p>

    

    
      
        <div class="pb-5 d-flex flex-justify-center">
          <div class="px-2">

    <a href="https://github.com/Prashantmdgl9/ml_experiments/tree/master/_notebooks/topicEmbeddingsFinal.ipynb" role="button" target="_blank">
<img class="notebook-badge-image" src="/ml_experiments/assets/badges/github.svg" alt="View On GitHub">
    </a>
</div>

          
          
          
        </div>
      </header>

  <div class="post-content e-content" itemprop="articleBody">
    <!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/topicEmbeddingsFinal.ipynb
-->

<div class="container" id="notebook-container">
        
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>pip install glove_python
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Collecting glove_python
  Downloading https://files.pythonhosted.org/packages/3e/79/7e7e548dd9dcb741935d031117f4bed133276c2a047aadad42f1552d1771/glove_python-0.1.0.tar.gz (263kB)
     |################################| 266kB 3.6MB/s 
Requirement already satisfied: numpy in /usr/local/lib/python3.5/dist-packages (from glove_python) (1.15.4)
Requirement already satisfied: scipy in /usr/local/lib/python3.5/dist-packages (from glove_python) (1.1.0)
Building wheels for collected packages: glove-python
  Building wheel for glove-python (setup.py) ... done
  Stored in directory: /root/.cache/pip/wheels/88/4b/6d/10c0d2ad32c9d9d68beec9694a6f0b6e83ab1662a90a089a4b
Successfully built glove-python
Installing collected packages: glove-python
Successfully installed glove-python-0.1.0
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">turicreate</span> <span class="k">as</span> <span class="nn">tc</span>
<span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">combinations</span>
<span class="kn">import</span> <span class="nn">turicreate.aggregate</span> <span class="k">as</span> <span class="nn">agg</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">tc</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">set_runtime_config</span><span class="p">(</span><span class="s1">&#39;TURI_DEFAULT_NUM_PYLAMBDA_WORKERS&#39;</span><span class="p">,</span> <span class="mi">64</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">glove</span> <span class="kn">import</span> <span class="n">Glove</span>
<span class="kn">from</span> <span class="nn">glove</span> <span class="kn">import</span> <span class="n">Corpus</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Read-Data">Read Data<a class="anchor-link" href="#Read-Data"> </a></h1>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">topics</span> <span class="o">=</span> <span class="n">tc</span><span class="o">.</span><span class="n">SFrame</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;/data/notebooks/PersonalityPred/ScoredTopics.csv&#39;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">topics</span><span class="o">.</span><span class="n">print_rows</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>+--------------+------------+--------------------+
|      X1      |     X2     |         X3         |
+--------------+------------+--------------------+
| 447341250114 |   airbnb   | 1.9547491087071431 |
| 447341250114 | apartment  | 1.9547491087071431 |
| 447341250114 | apple inc. | 9.387984787699388  |
+--------------+------------+--------------------+
[395337386 rows x 3 columns]

</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">topics</span> <span class="o">=</span> <span class="n">topics</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s1">&#39;X1&#39;</span><span class="p">:</span> <span class="s1">&#39;userID&#39;</span><span class="p">,</span> <span class="s1">&#39;X2&#39;</span><span class="p">:</span> <span class="s1">&#39;topic&#39;</span><span class="p">,</span> <span class="s1">&#39;X3&#39;</span><span class="p">:</span> <span class="s1">&#39;score&#39;</span><span class="p">})</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">turicreate.aggregate</span> <span class="k">as</span> <span class="nn">agg</span>
<span class="n">topics_agg</span> <span class="o">=</span> <span class="n">topics</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;userID&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;topics&#39;</span><span class="p">:</span> <span class="n">agg</span><span class="o">.</span><span class="n">CONCAT</span><span class="p">(</span><span class="s1">&#39;topic&#39;</span><span class="p">)})</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">topics_agg</span><span class="o">.</span><span class="n">print_rows</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>+--------------+-------------------------------+
|    userID    |             topics            |
+--------------+-------------------------------+
| 447787571427 | [instant messaging, photo ... |
| 447972320460 | [apple inc., cloud storage... |
| 447427607839 | [broadsheets, facebook, fr... |
+--------------+-------------------------------+
[1863980 rows x 2 columns]

</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">topics_agg</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;./topicsConcat&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Create-Combinations">Create Combinations<a class="anchor-link" href="#Create-Combinations"> </a></h1>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">topics_agg</span> <span class="o">=</span> <span class="n">tc</span><span class="o">.</span><span class="n">load_sframe</span><span class="p">(</span><span class="s1">&#39;./topicsConcat&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">topics_agg</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(1863980, 2)</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">topics_agg_samp</span> <span class="o">=</span> <span class="n">topics_agg</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">seed</span> <span class="o">=</span> <span class="mi">234</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">topic1</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">topic2</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">topics_agg_samp</span><span class="p">:</span>
    <span class="n">comb</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">combinations</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;topics&#39;</span><span class="p">],</span> <span class="mi">2</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">pair</span> <span class="ow">in</span> <span class="n">comb</span><span class="p">:</span>
        <span class="n">topic1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pair</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">topic2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pair</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">col1</span> <span class="o">=</span> <span class="n">tc</span><span class="o">.</span><span class="n">SArray</span><span class="p">(</span><span class="n">topic1</span><span class="p">)</span>
<span class="n">col2</span> <span class="o">=</span> <span class="n">tc</span><span class="o">.</span><span class="n">SArray</span><span class="p">(</span><span class="n">topic2</span><span class="p">)</span>
<span class="n">sf</span> <span class="o">=</span> <span class="n">tc</span><span class="o">.</span><span class="n">SFrame</span><span class="p">({</span><span class="s1">&#39;topic1&#39;</span><span class="p">:</span><span class="n">col1</span><span class="p">,</span><span class="s1">&#39;topic2&#39;</span><span class="p">:</span><span class="n">col2</span><span class="p">})</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sf</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;./sf_frame_combinations&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Create-Co-occurrence-Matrix">Create Co-occurrence Matrix<a class="anchor-link" href="#Create-Co-occurrence-Matrix"> </a></h1>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sf</span> <span class="o">=</span> <span class="n">tc</span><span class="o">.</span><span class="n">load_sframe</span><span class="p">(</span><span class="s1">&#39;./sf_frame_combinations&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">count_topic_combs</span> <span class="o">=</span> <span class="n">sf</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;topic1&#39;</span><span class="p">,</span> <span class="s1">&#39;topic2&#39;</span><span class="p">],</span> <span class="n">agg</span><span class="o">.</span><span class="n">COUNT</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">count_topic_combs</span><span class="o">.</span><span class="n">print_rows</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>+---------------------+-------------------------------+-------+
|        topic1       |             topic2            | Count |
+---------------------+-------------------------------+-------+
|     foot locker     |          formal wear          |   3   |
| strategy video game | strikeforce (mixed martial... |   1   |
|  o2audience:TENNIS  |       betting exchanges       |   6   |
+---------------------+-------------------------------+-------+
[11271195 rows x 3 columns]

</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">comb_samp</span> <span class="o">=</span> <span class="n">count_topic_combs</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">50</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">comb_samp</span><span class="o">.</span><span class="n">print_rows</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>+--------------------------------+-------------------------------+-------+
|             topic1             |             topic2            | Count |
+--------------------------------+-------------------------------+-------+
|          foot locker           |          formal wear          |   3   |
|      strategy video game       | strikeforce (mixed martial... |   1   |
|       o2audience:TENNIS        |       betting exchanges       |   6   |
|        personalization         |          supermarkets         |   23  |
|       expedia (website)        |          little tikes         |   9   |
|          hotel du vin          |     newcastle united f.c.     |   1   |
|          dictionaries          |            pet food           |   1   |
|           change.org           |        vehicle recovery       |   34  |
|             dance              |           supergroup          |   2   |
|        fortnum &amp; mason         |          desi cuisine         |   1   |
|     remote backup service      |          adult comics         |   1   |
|        tv listings (uk)        |     children&#39;s literature     |   4   |
|          conferences           |            bandcamp           |   1   |
|          crowdfunding          |           genealogy           |   20  |
|            matalan             |       primary education       |   6   |
|        award ceremonies        |         travel website        |   1   |
|             opodo              |            jogging            |   3   |
|           audiobook            |             intel             |   1   |
|            holiday             |         ibrox stadium         |   1   |
|              jeep              |         athletic shoes        |   1   |
|           bridesmaid           |             cruise            |   1   |
|            hip hop             |       birmingham airport      |   3   |
|             icloud             |      versatile (company)      |   1   |
|           teppanyaki           | o2audience:FITNESS &amp; EXERCISE |   1   |
|         hot beverages          |       news broadcasting       |   4   |
|              h&amp;m               |   conservation organizations  |   1   |
|           havaianas            |          healthy diet         |   6   |
|            renting             |           fine print          |   1   |
|        listed building         | national lottery (united k... |   10  |
|           hair care            |         energy markets        |   1   |
|      windows phone games       |         absolute radio        |   3   |
| digital terrestrial television |         jack daniel&#39;s         |   1   |
|        aquatic ecology         |          tate britain         |   1   |
|       instant messaging        |       luxury real estate      |   2   |
|          dermatology           |         athletic shoes        |   3   |
|    undergraduate education     |       volkswagen beetle       |   1   |
|        garden furniture        |         scottish power        |   1   |
|             baking             |          trade unions         |   1   |
|           logistics            |          fulham f.c.          |   1   |
|          sutton park           |              mbna             |   1   |
|            homebase            |      photography websites     |   5   |
|         car dealership         |      mitsubishi outlander     |   1   |
|            space.nk            |      o2audience:TABLOIDS      |   6   |
|         fantasy books          |       private education       |   3   |
|        english heritage        |             dating            |   13  |
|           selfridges           | o2audience:ALTERNATIVE ROC... |   16  |
|          fieldfisher           |         food and drink        |   1   |
|         rock festivals         |            renting            |   7   |
|              beds              |          lloyds bank          |   26  |
|      o2audience:TAKE-AWAY      |    the punch bowl, mayfair    |   1   |
+--------------------------------+-------------------------------+-------+
[50 rows x 3 columns]

</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">col_co</span> <span class="o">=</span> <span class="n">comb_samp</span><span class="p">[</span><span class="s1">&#39;topic1&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
<span class="n">col_row</span> <span class="o">=</span> <span class="n">comb_samp</span><span class="p">[</span><span class="s1">&#39;topic2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">col_co</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>50</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">diff</span><span class="p">(</span><span class="n">li1</span><span class="p">,</span> <span class="n">li2</span><span class="p">):</span> 
    <span class="k">return</span> <span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">li1</span><span class="p">)</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">li2</span><span class="p">)))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">differ1</span> <span class="o">=</span> <span class="n">diff</span><span class="p">(</span><span class="n">col_row</span><span class="p">,</span> <span class="n">col_co</span><span class="p">)</span>
<span class="n">differ2</span> <span class="o">=</span> <span class="n">diff</span><span class="p">(</span><span class="n">col_co</span><span class="p">,</span> <span class="n">col_row</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>48
49
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">merged_features</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">col_co</span><span class="p">)</span> <span class="o">+</span> <span class="n">differ1</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">features</span> <span class="o">=</span> <span class="n">tc</span><span class="o">.</span><span class="n">SFrame</span><span class="p">(</span><span class="n">merged_features</span><span class="p">)</span>
<span class="n">features</span><span class="p">[</span><span class="s1">&#39;idx&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">merged_features</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">features</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">features</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">matrix</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(98, 98)</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">comb_samp</span><span class="p">:</span>
    <span class="n">i</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;topic1&#39;</span><span class="p">]</span>
    <span class="n">j</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;topic2&#39;</span><span class="p">]</span>
    <span class="n">score</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Count&#39;</span><span class="p">]</span>
    <span class="n">iIdx</span> <span class="o">=</span> <span class="n">features</span><span class="p">[</span><span class="n">features</span><span class="p">[</span><span class="s1">&#39;X1&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">i</span><span class="p">][</span><span class="s1">&#39;idx&#39;</span><span class="p">]</span>
    <span class="n">jIdx</span> <span class="o">=</span> <span class="n">features</span><span class="p">[</span><span class="n">features</span><span class="p">[</span><span class="s1">&#39;X1&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">j</span><span class="p">][</span><span class="s1">&#39;idx&#39;</span><span class="p">]</span>
    
    <span class="n">matrix</span><span class="p">[</span><span class="n">iIdx</span><span class="p">,</span> <span class="n">jIdx</span><span class="p">]</span> <span class="o">=</span> <span class="n">score</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>34 85 3
35 75 1
0 89 6
38 57 23
44 62 9
17 65 1
28 94 1
47 86 34
2 54 2
46 71 1
19 72 1
1 80 4
27 70 1
25 68 20
33 76 6
29 77 1
8 51 3
32 56 1
42 69 1
3 84 1
23 90 1
15 97 3
26 95 1
9 58 1
43 55 4
11 67 1
24 78 6
20 52 1
39 59 10
5 92 1
7 63 3
13 87 1
49 64 1
40 53 2
4 84 3
16 50 1
21 79 1
41 88 1
31 66 1
37 93 1
18 60 5
12 91 1
30 81 6
36 96 3
10 61 13
22 82 16
45 73 1
6 20 7
48 83 26
14 74 1
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">lookup_dict</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">features</span><span class="p">:</span>
    <span class="n">lookup_dict</span><span class="p">[</span><span class="n">element</span><span class="p">[</span><span class="s1">&#39;X1&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">element</span><span class="p">[</span><span class="s1">&#39;idx&#39;</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">matrix</span><span class="p">[</span><span class="mi">14</span><span class="p">][</span><span class="mi">74</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>1.0</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;./cooccurMatrix&#39;</span><span class="p">,</span> <span class="n">matrix</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.sparse</span> <span class="kn">import</span> <span class="n">coo_matrix</span>
<span class="n">c_mat</span> <span class="o">=</span> <span class="n">coo_matrix</span><span class="p">(</span><span class="n">matrix</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Building-Embeddings">Building Embeddings<a class="anchor-link" href="#Building-Embeddings"> </a></h1>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">glove</span> <span class="o">=</span> <span class="n">Glove</span><span class="p">(</span><span class="n">no_components</span><span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="n">learning_rate</span><span class="o">=</span> <span class="mf">0.5</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">glove</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">c_mat</span><span class="p">,</span> <span class="n">epochs</span> <span class="o">=</span> <span class="mi">30</span><span class="p">,</span> <span class="n">no_threads</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span> <span class="n">verbose</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Performing 30 training epochs with 4 threads
Epoch 0
Epoch 1
Epoch 2
Epoch 3
Epoch 4
Epoch 5
Epoch 6
Epoch 7
Epoch 8
Epoch 9
Epoch 10
Epoch 11
Epoch 12
Epoch 13
Epoch 14
Epoch 15
Epoch 16
Epoch 17
Epoch 18
Epoch 19
Epoch 20
Epoch 21
Epoch 22
Epoch 23
Epoch 24
Epoch 25
Epoch 26
Epoch 27
Epoch 28
Epoch 29
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">glove</span><span class="o">.</span><span class="n">add_dictionary</span><span class="p">(</span><span class="n">lookup_dict</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">glove</span><span class="o">.</span><span class="n">most_similar</span><span class="p">(</span><span class="s1">&#39;dance&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[(&#39;healthy diet&#39;, 0.92553703643116),
 (&#39;bandcamp&#39;, 0.924506085474508),
 (&#39;vehicle recovery&#39;, 0.9025076918595519),
 (&#39;change.org&#39;, 0.901353452243554)]</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">glove</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;glove.model&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">features</span><span class="p">[</span><span class="s1">&#39;embeddings&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">glove</span><span class="o">.</span><span class="n">word_vectors</span>
<span class="n">features</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;./topicEmbeddings3d&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">features</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div style="max-height:1000px;max-width:1500px;overflow:auto;"><table frame="box" rules="cols">
    <tr>
        <th style="padding-left: 1em; padding-right: 1em; text-align: center">X1</th>
        <th style="padding-left: 1em; padding-right: 1em; text-align: center">embeddings</th>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">o2audience:TENNIS</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">[-0.25590186831341794,<br />-0.10507115523421791, ...</td>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">tv listings (uk)</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">[-0.15299538565246212,<br />0.06522701523406063, ...</td>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">dance</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">[0.048705577857946825,<br />-0.06441650907482477, ...</td>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">jeep</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">[-0.012075309501221331,<br />0.007716132573596034, ...</td>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">dermatology</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">[-0.13284929977707105,<br />-0.09501078610233918, ...</td>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">hair care</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">[-0.020616192059875173,<br />-0.11343396734128898, ...</td>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">rock festivals</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">[-0.19858491196146452,<br />0.07103996327525687, ...</td>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">windows phone games</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">[0.1254480146499355,<br />-0.07543661813548388, ...</td>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">opodo</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">[-0.033564251313613985,<br />0.026202752127400565, ...</td>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">teppanyaki</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">[0.12177376835567781,<br />-0.06265174139718836, ...</td>
    </tr>
</table>
[98 rows x 2 columns]<br />Note: Only the head of the SFrame is printed.<br />You can use print_rows(num_rows=m, num_columns=n) to print more rows and columns.
</div>
</div>

</div>

</div>
</div>

</div>
    

</div>



  </div><a class="u-url" href="/ml_experiments/2022/09/07/topicEmbeddingsFinal.html" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/ml_experiments/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <ul class="contact-list">
          <li class="p-name">Prashant Mudgal</li>
          <li><a class="u-email" href="mailto:prashantmdgl9@gmail.com">prashantmdgl9@gmail.com</a></li>
        </ul>
      </div>
      <div class="footer-col">
        <p></p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li><a rel="me" href="https://github.com/Prashantmdgl9" target="_blank" title="Prashantmdgl9"><svg class="svg-icon grey"><use xlink:href="/ml_experiments/assets/minima-social-icons.svg#github"></use></svg></a></li><li><a rel="me" href="https://twitter.com/prashantmdgl9" target="_blank" title="prashantmdgl9"><svg class="svg-icon grey"><use xlink:href="/ml_experiments/assets/minima-social-icons.svg#twitter"></use></svg></a></li></ul>
</div>

  </div>

</footer>
</body>

</html>

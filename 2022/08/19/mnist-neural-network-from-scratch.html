<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="twitter:card" content="summary_large_image" /><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Forward and Backpropagation with High School Mathematics | Musings of Learning Machine Learning</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="Forward and Backpropagation with High School Mathematics" />
<meta name="author" content="Prashant Mudgal" />
<meta property="og:locale" content="en_US" />
<link rel="canonical" href="https://prashantmdgl9.github.io/ml_experiments/2022/08/19/mnist-neural-network-from-scratch.html" />
<meta property="og:url" content="https://prashantmdgl9.github.io/ml_experiments/2022/08/19/mnist-neural-network-from-scratch.html" />
<meta property="og:site_name" content="Musings of Learning Machine Learning" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2022-08-19T00:00:00-05:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Forward and Backpropagation with High School Mathematics" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Prashant Mudgal"},"dateModified":"2022-08-19T00:00:00-05:00","datePublished":"2022-08-19T00:00:00-05:00","headline":"Forward and Backpropagation with High School Mathematics","mainEntityOfPage":{"@type":"WebPage","@id":"https://prashantmdgl9.github.io/ml_experiments/2022/08/19/mnist-neural-network-from-scratch.html"},"url":"https://prashantmdgl9.github.io/ml_experiments/2022/08/19/mnist-neural-network-from-scratch.html"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/ml_experiments/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://prashantmdgl9.github.io/ml_experiments/feed.xml" title="Musings of Learning Machine Learning" /><link rel="shortcut icon" type="image/x-icon" href="/ml_experiments/images/favicon2.ico">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Primer/15.2.0/primer.css" integrity="sha512-xTz2ys4coGAOz8vuV1NcQBkgVmKhsSEtjbqyMJbBHRplFuvKIUo6xhLHpAyPt9mfR6twHJgn9OgVLuqOvjeBhg==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous" />

<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title") && (el.className != "emoji")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/ml_experiments/">Musings of Learning Machine Learning</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/ml_experiments/about/">About Me</a><a class="page-link" href="/ml_experiments/Applications/">Applications</a><a class="page-link" href="/ml_experiments/CV/">Professional Portfolio</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Forward and Backpropagation with High School Mathematics</h1><p class="post-meta post-meta-title"><time class="dt-published" datetime="2022-08-19T00:00:00-05:00" itemprop="datePublished">
        Aug 19, 2022
      </time>
       â€¢ <span class="read-time" title="Estimated read time">
    
    
      10 min read
    
</span></p>

    

    
      
        <div class="pb-5 d-flex flex-justify-center">
          <div class="px-2">

    <a href="https://github.com/Prashantmdgl9/ml_experiments/tree/master/_notebooks/2022-08-19-mnist-neural-network-from-scratch.ipynb" role="button" target="_blank">
<img class="notebook-badge-image" src="/ml_experiments/assets/badges/github.svg" alt="View On GitHub">
    </a>
</div>

          
          
          
        </div>
      </header>

  <div class="post-content e-content" itemprop="articleBody">
    <!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2022-08-19-mnist-neural-network-from-scratch.ipynb
-->

<div class="container" id="notebook-container">
        
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<blockquote><p><strong><em>Problem statement</em></strong> - Classify the hand written digits with help of a basic neural net designed from scratch</p>
</blockquote>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<blockquote><p><strong><em>Data</em></strong> -  MNIST data present at <a href="https://www.kaggle.com/datasets/animatronbot/mnist-digit-recognizer">https://www.kaggle.com/datasets/animatronbot/mnist-digit-recognizer</a></p>
</blockquote>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<blockquote><p><strong><em>Methodology</em></strong> Write the forward and backpropagation functions from scratch using simple maths and calculus</p>
</blockquote>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Imports-and-Data-downloads">Imports and Data downloads<a class="anchor-link" href="#Imports-and-Data-downloads"> </a></h1>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;/kaggle/input/mnist-digit-recognizer/train.csv&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>label</th>
      <th>pixel0</th>
      <th>pixel1</th>
      <th>pixel2</th>
      <th>pixel3</th>
      <th>pixel4</th>
      <th>pixel5</th>
      <th>pixel6</th>
      <th>pixel7</th>
      <th>pixel8</th>
      <th>...</th>
      <th>pixel774</th>
      <th>pixel775</th>
      <th>pixel776</th>
      <th>pixel777</th>
      <th>pixel778</th>
      <th>pixel779</th>
      <th>pixel780</th>
      <th>pixel781</th>
      <th>pixel782</th>
      <th>pixel783</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>7</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>5</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>9</th>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>10 rows Ã— 785 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(42000, 785)</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Split-the-data-into-train-and-test-sets">Split the data into train and test sets<a class="anchor-link" href="#Split-the-data-into-train-and-test-sets"> </a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<blockquote><p><em>Transpose the data, so that one column is one image. The shape would be 785*42000 after transpose</em></p>
</blockquote>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="One-very-important-step-is-to-normalise-the-train-and-test-sets,-without-which-training-will-be-either-slow-or-just-not-effective-at-all.-X/255-takes-care-of-the-same">One very important step is to normalise the train and test sets, without which training will be either slow or just not effective at all. X/255 takes care of the same<a class="anchor-link" href="#One-very-important-step-is-to-normalise-the-train-and-test-sets,-without-which-training-will-be-either-slow-or-just-not-effective-at-all.-X/255-takes-care-of-the-same"> </a></h3>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">m</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="c1"># shuffle before splitting into test and training sets</span>

<span class="n">data_test</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2000</span><span class="p">]</span><span class="o">.</span><span class="n">T</span>
<span class="n">Y_test</span> <span class="o">=</span> <span class="n">data_test</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">X_test</span> <span class="o">=</span> <span class="n">data_test</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="n">n</span><span class="p">]</span>
<span class="n">X_test</span> <span class="o">=</span> <span class="n">X_test</span> <span class="o">/</span> <span class="mf">255.</span>

<span class="n">data_train</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mi">2000</span><span class="p">:</span><span class="n">m</span><span class="p">]</span><span class="o">.</span><span class="n">T</span>
<span class="n">Y_train</span> <span class="o">=</span> <span class="n">data_train</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">X_train</span> <span class="o">=</span> <span class="n">data_train</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="n">n</span><span class="p">]</span>
<span class="n">X_train</span> <span class="o">=</span> <span class="n">X_train</span> <span class="o">/</span> <span class="mf">255.</span>
<span class="n">_</span><span class="p">,</span><span class="n">m_train</span> <span class="o">=</span> <span class="n">X_train</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X_train</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(784, 40000)</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">Y_train</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([2, 6, 7, ..., 9, 5, 6])</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Neural-Net-Design">Neural Net Design<a class="anchor-link" href="#Neural-Net-Design"> </a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><a href="https://postimg.cc/rz3gX9Z3"><img src="https://i.postimg.cc/hPPYmyLD/Screenshot-2022-08-29-at-5-51-24-PM-min.png" alt="Screenshot-2022-08-29-at-5-51-24-PM-min.png" /></a></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Let's-conceptualise-the-mathematics-in-the-form-of-equations">Let's conceptualise the mathematics in the form of equations<a class="anchor-link" href="#Let's-conceptualise-the-mathematics-in-the-form-of-equations"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<blockquote><h2 id="Forward-Propagation"><strong><em>Forward Propagation</em></strong><a class="anchor-link" href="#Forward-Propagation"> </a></h2>
</blockquote>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><a href="https://postimg.cc/JHDqHy0p"><img src="https://i.postimg.cc/yxnr5cHC/Screenshot-2022-08-29-at-6-13-32-PM-min.png" alt="Screenshot-2022-08-29-at-6-13-32-PM-min.png" /></a></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<blockquote><h2 id="Backward-Propagation"><strong><em>Backward Propagation</em></strong><a class="anchor-link" href="#Backward-Propagation"> </a></h2>
</blockquote>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><a href="https://postimg.cc/LhnvbWDj"><img src="https://i.postimg.cc/VsFTdQbZ/Screenshot-2022-08-29-at-6-13-40-PM-min.png" alt="Screenshot-2022-08-29-at-6-13-40-PM-min.png" /></a></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<blockquote><h2 id="Updating-the-weights"><strong><em>Updating the weights</em></strong><a class="anchor-link" href="#Updating-the-weights"> </a></h2>
</blockquote>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><a href="https://postimg.cc/1nzMP7Qh"><img src="https://i.postimg.cc/KzPWPCpz/Screenshot-2022-08-29-at-6-13-47-PM-min.png" alt="Screenshot-2022-08-29-at-6-13-47-PM-min.png" /></a></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="The-calculus-involves-the-chain-rule">The calculus involves the chain rule<a class="anchor-link" href="#The-calculus-involves-the-chain-rule"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><a href="https://postimg.cc/gXBs0yzw"><img src="https://i.postimg.cc/1XyjJMbK/Screenshot-2022-08-29-at-6-14-21-PM-min.png" alt="Screenshot-2022-08-29-at-6-14-21-PM-min.png" /></a></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="In-the-above-figure,-if-we-want-to-update-the-weight-of-w5-then,-we-need-to-take-the-partial-derivative-of-Total-Error-function-wrt-w5.">In the above figure, if we want to update the weight of w5 then, we need to take the partial derivative of Total Error function wrt w5.<a class="anchor-link" href="#In-the-above-figure,-if-we-want-to-update-the-weight-of-w5-then,-we-need-to-take-the-partial-derivative-of-Total-Error-function-wrt-w5."> </a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><a href="https://postimg.cc/67czkJFf"><img src="https://i.postimg.cc/LXK7ZmTw/Screenshot-2022-08-29-at-6-14-31-PM-min.png" alt="Screenshot-2022-08-29-at-6-14-31-PM-min.png" /></a></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="But-total-error-doesn't-contain-any-term-with-w5,-so-we-use-chain-rule">But total error doesn't contain any term with w5, so we use chain rule<a class="anchor-link" href="#But-total-error-doesn't-contain-any-term-with-w5,-so-we-use-chain-rule"> </a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Let's-code-the-above-mathematics-into-python-functions">Let's code the above mathematics into python functions<a class="anchor-link" href="#Let's-code-the-above-mathematics-into-python-functions"> </a></h1>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">init_params</span><span class="p">():</span>
    <span class="n">W1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">784</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.5</span>
    <span class="n">b1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.5</span>
    <span class="n">W2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.5</span>
    <span class="n">b2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.5</span>
    <span class="k">return</span> <span class="n">W1</span><span class="p">,</span> <span class="n">b1</span><span class="p">,</span> <span class="n">W2</span><span class="p">,</span> <span class="n">b2</span>

<span class="k">def</span> <span class="nf">ReLU</span><span class="p">(</span><span class="n">Z</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">softmax</span><span class="p">(</span><span class="n">Z</span><span class="p">):</span>
    <span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">Z</span><span class="p">)</span> <span class="o">/</span> <span class="nb">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">Z</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">A</span>
    
<span class="k">def</span> <span class="nf">forward_prop</span><span class="p">(</span><span class="n">W1</span><span class="p">,</span> <span class="n">b1</span><span class="p">,</span> <span class="n">W2</span><span class="p">,</span> <span class="n">b2</span><span class="p">,</span> <span class="n">X</span><span class="p">):</span>
    <span class="n">Z1</span> <span class="o">=</span> <span class="n">W1</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">X</span><span class="p">)</span> <span class="o">+</span> <span class="n">b1</span>
    <span class="n">A1</span> <span class="o">=</span> <span class="n">ReLU</span><span class="p">(</span><span class="n">Z1</span><span class="p">)</span>
    <span class="n">Z2</span> <span class="o">=</span> <span class="n">W2</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">A1</span><span class="p">)</span> <span class="o">+</span> <span class="n">b2</span>
    <span class="n">A2</span> <span class="o">=</span> <span class="n">softmax</span><span class="p">(</span><span class="n">Z2</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Z1</span><span class="p">,</span> <span class="n">A1</span><span class="p">,</span> <span class="n">Z2</span><span class="p">,</span> <span class="n">A2</span>

<span class="k">def</span> <span class="nf">ReLU_deriv</span><span class="p">(</span><span class="n">Z</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">Z</span> <span class="o">&gt;</span> <span class="mi">0</span>

<span class="k">def</span> <span class="nf">one_hot</span><span class="p">(</span><span class="n">Y</span><span class="p">):</span>
    <span class="n">one_hot_Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">Y</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">Y</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
    <span class="n">one_hot_Y</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">Y</span><span class="o">.</span><span class="n">size</span><span class="p">),</span> <span class="n">Y</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">one_hot_Y</span> <span class="o">=</span> <span class="n">one_hot_Y</span><span class="o">.</span><span class="n">T</span>
    <span class="k">return</span> <span class="n">one_hot_Y</span>

<span class="k">def</span> <span class="nf">backward_prop</span><span class="p">(</span><span class="n">Z1</span><span class="p">,</span> <span class="n">A1</span><span class="p">,</span> <span class="n">Z2</span><span class="p">,</span> <span class="n">A2</span><span class="p">,</span> <span class="n">W1</span><span class="p">,</span> <span class="n">W2</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">):</span>
    <span class="n">one_hot_Y</span> <span class="o">=</span> <span class="n">one_hot</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span>
    <span class="n">dZ2</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">A2</span> <span class="o">-</span> <span class="n">one_hot_Y</span><span class="p">)</span>
    <span class="n">dW2</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">m</span> <span class="o">*</span> <span class="n">dZ2</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">A1</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
    <span class="n">db2</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">m</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">dZ2</span><span class="p">)</span>
    <span class="n">dZ1</span> <span class="o">=</span> <span class="n">W2</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">dZ2</span><span class="p">)</span> <span class="o">*</span> <span class="n">ReLU_deriv</span><span class="p">(</span><span class="n">Z1</span><span class="p">)</span>
    <span class="n">dW1</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">m</span> <span class="o">*</span> <span class="n">dZ1</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
    <span class="n">db1</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">m</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">dZ1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">dW1</span><span class="p">,</span> <span class="n">db1</span><span class="p">,</span> <span class="n">dW2</span><span class="p">,</span> <span class="n">db2</span>

<span class="k">def</span> <span class="nf">update_params</span><span class="p">(</span><span class="n">W1</span><span class="p">,</span> <span class="n">b1</span><span class="p">,</span> <span class="n">W2</span><span class="p">,</span> <span class="n">b2</span><span class="p">,</span> <span class="n">dW1</span><span class="p">,</span> <span class="n">db1</span><span class="p">,</span> <span class="n">dW2</span><span class="p">,</span> <span class="n">db2</span><span class="p">,</span> <span class="n">alpha</span><span class="p">):</span>
   <span class="c1"># print(W1.shape)</span>
   <span class="c1"># print(dW1.shape)</span>
    <span class="n">W1</span> <span class="o">=</span> <span class="n">W1</span> <span class="o">-</span> <span class="n">alpha</span> <span class="o">*</span> <span class="n">dW1</span>
    <span class="n">b1</span> <span class="o">=</span> <span class="n">b1</span> <span class="o">-</span> <span class="n">alpha</span> <span class="o">*</span> <span class="n">db1</span>    
    <span class="n">W2</span> <span class="o">=</span> <span class="n">W2</span> <span class="o">-</span> <span class="n">alpha</span> <span class="o">*</span> <span class="n">dW2</span>  
    <span class="n">b2</span> <span class="o">=</span> <span class="n">b2</span> <span class="o">-</span> <span class="n">alpha</span> <span class="o">*</span> <span class="n">db2</span>    
    <span class="k">return</span> <span class="n">W1</span><span class="p">,</span> <span class="n">b1</span><span class="p">,</span> <span class="n">W2</span><span class="p">,</span> <span class="n">b2</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<blockquote><h2 id="That's-where-we-do-the-Gradient-Descent.-We-call-it-gradient-descent-not-Stochastic-Gradient-Descent-because-we-are-running-the-net-on-entire-dataset-at-once-and-will-tweak-all-the-weights-and-biases-to-update-the-parameters"><em>That's where we do the Gradient Descent. We call it gradient descent not Stochastic Gradient Descent because we are running the net on entire dataset at once and will tweak all the weights and biases to update the parameters</em><a class="anchor-link" href="#That's-where-we-do-the-Gradient-Descent.-We-call-it-gradient-descent-not-Stochastic-Gradient-Descent-because-we-are-running-the-net-on-entire-dataset-at-once-and-will-tweak-all-the-weights-and-biases-to-update-the-parameters"> </a></h2>
</blockquote>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">get_predictions</span><span class="p">(</span><span class="n">A2</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">A2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">get_accuracy</span><span class="p">(</span><span class="n">predictions</span><span class="p">,</span> <span class="n">Y</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">predictions</span><span class="p">,</span> <span class="n">Y</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">predictions</span> <span class="o">==</span> <span class="n">Y</span><span class="p">)</span> <span class="o">/</span> <span class="n">Y</span><span class="o">.</span><span class="n">size</span>

<span class="k">def</span> <span class="nf">gradient_descent</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">iterations</span><span class="p">):</span>
    <span class="n">W1</span><span class="p">,</span> <span class="n">b1</span><span class="p">,</span> <span class="n">W2</span><span class="p">,</span> <span class="n">b2</span> <span class="o">=</span> <span class="n">init_params</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">iterations</span><span class="p">):</span>
        <span class="n">Z1</span><span class="p">,</span> <span class="n">A1</span><span class="p">,</span> <span class="n">Z2</span><span class="p">,</span> <span class="n">A2</span> <span class="o">=</span> <span class="n">forward_prop</span><span class="p">(</span><span class="n">W1</span><span class="p">,</span> <span class="n">b1</span><span class="p">,</span> <span class="n">W2</span><span class="p">,</span> <span class="n">b2</span><span class="p">,</span> <span class="n">X</span><span class="p">)</span>
        <span class="n">dW1</span><span class="p">,</span> <span class="n">db1</span><span class="p">,</span> <span class="n">dW2</span><span class="p">,</span> <span class="n">db2</span> <span class="o">=</span> <span class="n">backward_prop</span><span class="p">(</span><span class="n">Z1</span><span class="p">,</span> <span class="n">A1</span><span class="p">,</span> <span class="n">Z2</span><span class="p">,</span> <span class="n">A2</span><span class="p">,</span> <span class="n">W1</span><span class="p">,</span> <span class="n">W2</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">)</span>
        <span class="c1">#print(W1.shape)</span>
        <span class="c1">#print(dW1.shape)</span>
        <span class="n">W1</span><span class="p">,</span> <span class="n">b1</span><span class="p">,</span> <span class="n">W2</span><span class="p">,</span> <span class="n">b2</span> <span class="o">=</span> <span class="n">update_params</span><span class="p">(</span><span class="n">W1</span><span class="p">,</span> <span class="n">b1</span><span class="p">,</span> <span class="n">W2</span><span class="p">,</span> <span class="n">b2</span><span class="p">,</span> <span class="n">dW1</span><span class="p">,</span> <span class="n">db1</span><span class="p">,</span> <span class="n">dW2</span><span class="p">,</span> <span class="n">db2</span><span class="p">,</span> <span class="n">alpha</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">10</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Iteration: &quot;</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
            <span class="n">predictions</span> <span class="o">=</span> <span class="n">get_predictions</span><span class="p">(</span><span class="n">A2</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">get_accuracy</span><span class="p">(</span><span class="n">predictions</span><span class="p">,</span> <span class="n">Y</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">W1</span><span class="p">,</span> <span class="n">b1</span><span class="p">,</span> <span class="n">W2</span><span class="p">,</span> <span class="n">b2</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Let's-run-for-500-iterations">Let's run for 500 iterations<a class="anchor-link" href="#Let's-run-for-500-iterations"> </a></h3>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">W1</span><span class="p">,</span> <span class="n">b1</span><span class="p">,</span> <span class="n">W2</span><span class="p">,</span> <span class="n">b2</span> <span class="o">=</span> <span class="n">gradient_descent</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">Y_train</span><span class="p">,</span> <span class="mf">0.10</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Iteration:  0
[1 6 4 ... 6 1 6] [2 6 7 ... 9 5 6]
0.115775
Iteration:  10
[1 6 4 ... 4 1 6] [2 6 7 ... 9 5 6]
0.21905
Iteration:  20
[1 6 0 ... 0 1 0] [2 6 7 ... 9 5 6]
0.25965
Iteration:  30
[1 6 0 ... 0 3 6] [2 6 7 ... 9 5 6]
0.336025
Iteration:  40
[2 6 0 ... 0 3 6] [2 6 7 ... 9 5 6]
0.421125
Iteration:  50
[2 6 9 ... 0 5 6] [2 6 7 ... 9 5 6]
0.50025
Iteration:  60
[2 6 7 ... 0 5 6] [2 6 7 ... 9 5 6]
0.5673
Iteration:  70
[2 6 7 ... 4 5 6] [2 6 7 ... 9 5 6]
0.6161
Iteration:  80
[2 6 9 ... 9 5 6] [2 6 7 ... 9 5 6]
0.655525
Iteration:  90
[2 6 9 ... 4 5 6] [2 6 7 ... 9 5 6]
0.684975
Iteration:  100
[2 6 7 ... 4 5 6] [2 6 7 ... 9 5 6]
0.709775
Iteration:  110
[2 6 7 ... 4 5 6] [2 6 7 ... 9 5 6]
0.727575
Iteration:  120
[2 6 7 ... 4 5 6] [2 6 7 ... 9 5 6]
0.7433
Iteration:  130
[2 6 7 ... 4 5 6] [2 6 7 ... 9 5 6]
0.7566
Iteration:  140
[2 6 7 ... 4 5 6] [2 6 7 ... 9 5 6]
0.76835
Iteration:  150
[2 6 7 ... 4 5 6] [2 6 7 ... 9 5 6]
0.77935
Iteration:  160
[2 6 7 ... 4 5 6] [2 6 7 ... 9 5 6]
0.788825
Iteration:  170
[2 6 7 ... 4 5 6] [2 6 7 ... 9 5 6]
0.797025
Iteration:  180
[2 6 7 ... 4 5 6] [2 6 7 ... 9 5 6]
0.803525
Iteration:  190
[2 6 7 ... 4 5 6] [2 6 7 ... 9 5 6]
0.809125
Iteration:  200
[2 6 7 ... 4 5 6] [2 6 7 ... 9 5 6]
0.8141
Iteration:  210
[2 6 7 ... 9 5 6] [2 6 7 ... 9 5 6]
0.81925
Iteration:  220
[2 6 7 ... 9 5 6] [2 6 7 ... 9 5 6]
0.823775
Iteration:  230
[2 6 7 ... 9 5 6] [2 6 7 ... 9 5 6]
0.82825
Iteration:  240
[2 6 7 ... 9 5 6] [2 6 7 ... 9 5 6]
0.832775
Iteration:  250
[2 6 7 ... 9 5 6] [2 6 7 ... 9 5 6]
0.83605
Iteration:  260
[2 6 7 ... 9 5 6] [2 6 7 ... 9 5 6]
0.839275
Iteration:  270
[2 6 7 ... 9 5 6] [2 6 7 ... 9 5 6]
0.8428
Iteration:  280
[2 6 7 ... 9 5 6] [2 6 7 ... 9 5 6]
0.8452
Iteration:  290
[2 6 7 ... 9 5 6] [2 6 7 ... 9 5 6]
0.84755
Iteration:  300
[2 6 7 ... 9 5 6] [2 6 7 ... 9 5 6]
0.8499
Iteration:  310
[2 6 7 ... 9 5 6] [2 6 7 ... 9 5 6]
0.85185
Iteration:  320
[2 6 7 ... 9 5 6] [2 6 7 ... 9 5 6]
0.853975
Iteration:  330
[2 6 7 ... 9 5 6] [2 6 7 ... 9 5 6]
0.85605
Iteration:  340
[2 6 7 ... 9 5 6] [2 6 7 ... 9 5 6]
0.857625
Iteration:  350
[2 6 7 ... 9 5 6] [2 6 7 ... 9 5 6]
0.859125
Iteration:  360
[2 6 7 ... 9 5 6] [2 6 7 ... 9 5 6]
0.860575
Iteration:  370
[2 6 7 ... 9 5 6] [2 6 7 ... 9 5 6]
0.861725
Iteration:  380
[2 6 7 ... 9 5 6] [2 6 7 ... 9 5 6]
0.86305
Iteration:  390
[2 6 7 ... 9 5 6] [2 6 7 ... 9 5 6]
0.864325
Iteration:  400
[2 6 7 ... 9 5 6] [2 6 7 ... 9 5 6]
0.8654
Iteration:  410
[2 6 7 ... 9 5 6] [2 6 7 ... 9 5 6]
0.8664
Iteration:  420
[2 6 7 ... 9 5 6] [2 6 7 ... 9 5 6]
0.867725
Iteration:  430
[2 6 7 ... 9 5 6] [2 6 7 ... 9 5 6]
0.869125
Iteration:  440
[2 6 7 ... 9 5 6] [2 6 7 ... 9 5 6]
0.870275
Iteration:  450
[2 6 7 ... 9 5 6] [2 6 7 ... 9 5 6]
0.8711
Iteration:  460
[2 6 7 ... 9 5 6] [2 6 7 ... 9 5 6]
0.871975
Iteration:  470
[2 6 7 ... 9 5 6] [2 6 7 ... 9 5 6]
0.873
Iteration:  480
[2 6 7 ... 9 5 6] [2 6 7 ... 9 5 6]
0.87385
Iteration:  490
[2 6 7 ... 9 5 6] [2 6 7 ... 9 5 6]
0.874775
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">make_predictions</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">W1</span><span class="p">,</span> <span class="n">b1</span><span class="p">,</span> <span class="n">W2</span><span class="p">,</span> <span class="n">b2</span><span class="p">):</span>
    <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">A2</span> <span class="o">=</span> <span class="n">forward_prop</span><span class="p">(</span><span class="n">W1</span><span class="p">,</span> <span class="n">b1</span><span class="p">,</span> <span class="n">W2</span><span class="p">,</span> <span class="n">b2</span><span class="p">,</span> <span class="n">X</span><span class="p">)</span>
    <span class="n">predictions</span> <span class="o">=</span> <span class="n">get_predictions</span><span class="p">(</span><span class="n">A2</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">predictions</span>

<span class="k">def</span> <span class="nf">test_prediction</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">W1</span><span class="p">,</span> <span class="n">b1</span><span class="p">,</span> <span class="n">W2</span><span class="p">,</span> <span class="n">b2</span><span class="p">):</span>
    <span class="n">current_image</span> <span class="o">=</span> <span class="n">X_train</span><span class="p">[:,</span> <span class="n">index</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span>
    <span class="n">prediction</span> <span class="o">=</span> <span class="n">make_predictions</span><span class="p">(</span><span class="n">X_train</span><span class="p">[:,</span> <span class="n">index</span><span class="p">,</span> <span class="kc">None</span><span class="p">],</span> <span class="n">W1</span><span class="p">,</span> <span class="n">b1</span><span class="p">,</span> <span class="n">W2</span><span class="p">,</span> <span class="n">b2</span><span class="p">)</span>
    <span class="n">label</span> <span class="o">=</span> <span class="n">Y_train</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Prediction: &quot;</span><span class="p">,</span> <span class="n">prediction</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Label: &quot;</span><span class="p">,</span> <span class="n">label</span><span class="p">)</span>
    
    <span class="n">current_image</span> <span class="o">=</span> <span class="n">current_image</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">28</span><span class="p">,</span> <span class="mi">28</span><span class="p">))</span> <span class="o">*</span> <span class="mi">255</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">gray</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">current_image</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_prediction</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">W1</span><span class="p">,</span> <span class="n">b1</span><span class="p">,</span> <span class="n">W2</span><span class="p">,</span> <span class="n">b2</span><span class="p">)</span>
<span class="n">test_prediction</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">W1</span><span class="p">,</span> <span class="n">b1</span><span class="p">,</span> <span class="n">W2</span><span class="p">,</span> <span class="n">b2</span><span class="p">)</span>
<span class="n">test_prediction</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">W1</span><span class="p">,</span> <span class="n">b1</span><span class="p">,</span> <span class="n">W2</span><span class="p">,</span> <span class="n">b2</span><span class="p">)</span>
<span class="n">test_prediction</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="n">W1</span><span class="p">,</span> <span class="n">b1</span><span class="p">,</span> <span class="n">W2</span><span class="p">,</span> <span class="n">b2</span><span class="p">)</span>
<span class="n">test_prediction</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="n">W1</span><span class="p">,</span> <span class="n">b1</span><span class="p">,</span> <span class="n">W2</span><span class="p">,</span> <span class="n">b2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Prediction:  [2]
Label:  2
</pre>
</div>
</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
" />
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Prediction:  [6]
Label:  6
</pre>
</div>
</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
" />
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Prediction:  [7]
Label:  7
</pre>
</div>
</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
" />
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Prediction:  [8]
Label:  8
</pre>
</div>
</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
" />
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Prediction:  [9]
Label:  9
</pre>
</div>
</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
" />
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_predictions</span> <span class="o">=</span> <span class="n">make_predictions</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">W1</span><span class="p">,</span> <span class="n">b1</span><span class="p">,</span> <span class="n">W2</span><span class="p">,</span> <span class="n">b2</span><span class="p">)</span>
<span class="n">get_accuracy</span><span class="p">(</span><span class="n">test_predictions</span><span class="p">,</span> <span class="n">Y_test</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[5 2 5 ... 4 1 0] [5 2 5 ... 4 1 0]
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>0.867</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Accuracy-of-86%-on-the-test-set.">Accuracy of 86% on the test set.<a class="anchor-link" href="#Accuracy-of-86%-on-the-test-set."> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="End-of-notebook">End of notebook<a class="anchor-link" href="#End-of-notebook"> </a></h1>
</div>
</div>
</div>
</div>



  </div><a class="u-url" href="/ml_experiments/2022/08/19/mnist-neural-network-from-scratch.html" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/ml_experiments/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <ul class="contact-list">
          <li class="p-name">Prashant Mudgal</li>
          <li><a class="u-email" href="mailto:prashantmdgl9@gmail.com">prashantmdgl9@gmail.com</a></li>
        </ul>
      </div>
      <div class="footer-col">
        <p></p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li><a rel="me" href="https://github.com/Prashantmdgl9" target="_blank" title="Prashantmdgl9"><svg class="svg-icon grey"><use xlink:href="/ml_experiments/assets/minima-social-icons.svg#github"></use></svg></a></li><li><a rel="me" href="https://twitter.com/prashantmdgl9" target="_blank" title="prashantmdgl9"><svg class="svg-icon grey"><use xlink:href="/ml_experiments/assets/minima-social-icons.svg#twitter"></use></svg></a></li></ul>
</div>

  </div>

</footer>
</body>

</html>
